name: PostHog Session Analysis with Continue CLI Agent

on:
  schedule: 
  - cron: "0 6 * * *" # Run at 6 AM UTC daily
  workflow_dispatch: # Allow manual triggering

jobs:
  analyze:
    runs-on: ubuntu-latest

    permissions:
        contents: read
        issues: write

    steps:
    - uses: actions/checkout@v4

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: "20"

    - name: Install Continue CLI
      run: |
        npm install -g @continuedev/cli
        echo "‚úÖ Continue CLI installed"
    

    - name: Run Continue Agent
      env:
        CONTINUE_API_KEY: ${{ secrets.CONTINUE_API_KEY }}
      run: |
        cn --config continuedev/awesome-models-posthog-gh -p "Analyze PostHog sessions and create GitHub issues for UX problems"

    - name: Summary
      run: |
        echo "‚úÖ PostHog analysis workflow completed!"
        echo "üìä Check the artifacts for detailed analysis results"
        echo "üêõ Check your repository issues for newly created UX issues"
        echo "ü§ñ Agent automatically handled both analysis and issue creation"